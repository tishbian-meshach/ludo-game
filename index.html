<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/flaticon.png" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="theme-color" content="#1A1A2E" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
    <title>Premium Ludo</title>
    <link rel="stylesheet" href="/src/styles/ui.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #010325;
            font-family: 'Outfit', 'Segoe UI', system-ui, -apple-system, sans-serif;
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        /* Background image layer with opacity */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('/game-bg.jpg') center center / cover no-repeat;
            opacity: 0.5;
            z-index: 0;
            mix-blend-mode: overlay;
            pointer-events: none;
        }

        /* Mobile portrait: rotate background 90deg */
        @media (orientation: portrait) {
            body::before {
                width: 100vh;
                height: 100vw;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(90deg);
            }
        }

        #game-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        #canvas-board {
            position: absolute;
            z-index: 1;
        }

        #canvas-tokens {
            position: absolute;
            z-index: 2;
        }

        #canvas-3d {
            position: absolute;
            z-index: 3;
            pointer-events: none;
        }

        #ui-canvas {
            position: absolute;
            z-index: 4;
            pointer-events: none;
        }

        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1A1A2E 0%, #0F0F1A 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            transition: opacity 0.5s ease;
        }

        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #2A2A4A;
            border-top-color: #E53935;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
    </div>
    <div id="ui-layer">
        <!-- Start Screen -->
        <div id="start-screen" class="screen active">
            <div class="logo-container">
                <img src="/src/assets/logo.png" alt="Ludo" class="game-logo">
            </div>
            <button id="btn-play-initial" class="btn-primary">PLAY LUDO</button>
        </div>

        <!-- Setup Screen -->
        <div id="setup-screen" class="screen hidden">
            <div class="modal-content">
                <h2>GAME SETUP</h2>

                <div class="form-group">
                    <label>Select Players</label>
                    <div class="player-grid">
                        <!-- Red - Top Left -->
                        <div class="player-cell selected" data-player="0" data-color="red">
                            <div class="cell-bg-letter">R</div>
                            <div class="player-tag">
                                <span class="color-dot red"></span>
                                <input type="text" id="p0-name" value="Player 1" placeholder="Name">
                                <span class="edit-icon">✎</span>
                            </div>
                            <div class="player-type-toggle">
                                <button class="type-btn human active" data-type="human">
                                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                        <path
                                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                    </svg>
                                </button>
                                <button class="type-btn bot" data-type="bot">
                                    <svg viewBox="0 0 100 125" width="16" height="16" fill="currentColor"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M90,36.667h-4.167L79.98,47.312l-0.82-7.373C78.555,34.473,73.558,30,68.057,30H53.333v-7.591  c1.986-1.156,3.334-3.281,3.334-5.743C56.667,12.985,53.682,10,50,10s-6.666,2.985-6.666,6.667c0,2.461,1.349,4.586,3.332,5.743V30  H31.941c-5.5,0-10.496,4.473-11.104,9.938l-0.818,7.369l-5.854-10.641H10l3.334,26.666h4.904l-1.49,13.415  C15.938,84.036,21.274,90,28.608,90H71.39c7.334,0,12.673-5.964,11.862-13.252l-1.491-13.415h4.906L90,36.667z M60,80H40v-6.667h20  V80z M70,60c0,2.751-2.249,5-5,5H35c-2.75,0-5-2.249-5-5V48.333c0-2.75,2.25-5,5-5h30c2.751,0,5,2.25,5,5V60z" />
                                        <path
                                            d="M38.334,52.5c0-1.843,1.492-3.333,3.332-3.333c1.844,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.49,3.334-3.334,3.334  c-1.84,0-3.332-1.491-3.332-3.334V52.5z" />
                                        <path
                                            d="M55,52.5c0-1.843,1.491-3.333,3.333-3.333c1.843,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.491,3.334-3.334,3.334  c-1.842,0-3.333-1.491-3.333-3.334V52.5z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <!-- Green - Top Right -->
                        <div class="player-cell" data-player="1" data-color="green">
                            <div class="cell-bg-letter">G</div>
                            <div class="player-tag">
                                <span class="color-dot green"></span>
                                <input type="text" id="p1-name" value="Player 2" placeholder="Name">
                                <span class="edit-icon">✎</span>
                            </div>
                            <div class="player-type-toggle">
                                <button class="type-btn human active" data-type="human">
                                    <svg viewBox="0 0 24 25" width="18" height="18" fill="currentColor">
                                        <path
                                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                    </svg>
                                </button>
                                <button class="type-btn bot" data-type="bot">
                                    <svg viewBox="0 0 100 125" width="16" height="16" fill="currentColor"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M90,36.667h-4.167L79.98,47.312l-0.82-7.373C78.555,34.473,73.558,30,68.057,30H53.333v-7.591  c1.986-1.156,3.334-3.281,3.334-5.743C56.667,12.985,53.682,10,50,10s-6.666,2.985-6.666,6.667c0,2.461,1.349,4.586,3.332,5.743V30  H31.941c-5.5,0-10.496,4.473-11.104,9.938l-0.818,7.369l-5.854-10.641H10l3.334,26.666h4.904l-1.49,13.415  C15.938,84.036,21.274,90,28.608,90H71.39c7.334,0,12.673-5.964,11.862-13.252l-1.491-13.415h4.906L90,36.667z M60,80H40v-6.667h20  V80z M70,60c0,2.751-2.249,5-5,5H35c-2.75,0-5-2.249-5-5V48.333c0-2.75,2.25-5,5-5h30c2.751,0,5,2.25,5,5V60z" />
                                        <path
                                            d="M38.334,52.5c0-1.843,1.492-3.333,3.332-3.333c1.844,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.49,3.334-3.334,3.334  c-1.84,0-3.332-1.491-3.332-3.334V52.5z" />
                                        <path
                                            d="M55,52.5c0-1.843,1.491-3.333,3.333-3.333c1.843,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.491,3.334-3.334,3.334  c-1.842,0-3.333-1.491-3.333-3.334V52.5z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <!-- Blue - Bottom Left -->
                        <div class="player-cell" data-player="3" data-color="blue">
                            <div class="cell-bg-letter">B</div>
                            <div class="player-tag">
                                <span class="color-dot blue"></span>
                                <input type="text" id="p3-name" value="Player 4" placeholder="Name">
                                <span class="edit-icon">✎</span>
                            </div>
                            <div class="player-type-toggle">
                                <button class="type-btn human active" data-type="human">
                                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                        <path
                                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                    </svg>
                                </button>
                                <button class="type-btn bot" data-type="bot">
                                    <svg viewBox="0 0 100 125" width="16" height="16" fill="currentColor"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M90,36.667h-4.167L79.98,47.312l-0.82-7.373C78.555,34.473,73.558,30,68.057,30H53.333v-7.591  c1.986-1.156,3.334-3.281,3.334-5.743C56.667,12.985,53.682,10,50,10s-6.666,2.985-6.666,6.667c0,2.461,1.349,4.586,3.332,5.743V30  H31.941c-5.5,0-10.496,4.473-11.104,9.938l-0.818,7.369l-5.854-10.641H10l3.334,26.666h4.904l-1.49,13.415  C15.938,84.036,21.274,90,28.608,90H71.39c7.334,0,12.673-5.964,11.862-13.252l-1.491-13.415h4.906L90,36.667z M60,80H40v-6.667h20  V80z M70,60c0,2.751-2.249,5-5,5H35c-2.75,0-5-2.249-5-5V48.333c0-2.75,2.25-5,5-5h30c2.751,0,5,2.25,5,5V60z" />
                                        <path
                                            d="M38.334,52.5c0-1.843,1.492-3.333,3.332-3.333c1.844,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.49,3.334-3.334,3.334  c-1.84,0-3.332-1.491-3.332-3.334V52.5z" />
                                        <path
                                            d="M55,52.5c0-1.843,1.491-3.333,3.333-3.333c1.843,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.491,3.334-3.334,3.334  c-1.842,0-3.333-1.491-3.333-3.334V52.5z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <!-- Yellow - Bottom Right -->
                        <div class="player-cell selected" data-player="2" data-color="yellow">
                            <div class="cell-bg-letter">Y</div>
                            <div class="player-tag">
                                <span class="color-dot yellow"></span>
                                <input type="text" id="p2-name" value="Player 3" placeholder="Name">
                                <span class="edit-icon">✎</span>
                            </div>
                            <div class="player-type-toggle">
                                <button class="type-btn human active" data-type="human">
                                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                        <path
                                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                    </svg>
                                </button>
                                <button class="type-btn bot" data-type="bot">
                                    <svg viewBox="0 0 100 125" width="16" height="16" fill="currentColor"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M90,36.667h-4.167L79.98,47.312l-0.82-7.373C78.555,34.473,73.558,30,68.057,30H53.333v-7.591  c1.986-1.156,3.334-3.281,3.334-5.743C56.667,12.985,53.682,10,50,10s-6.666,2.985-6.666,6.667c0,2.461,1.349,4.586,3.332,5.743V30  H31.941c-5.5,0-10.496,4.473-11.104,9.938l-0.818,7.369l-5.854-10.641H10l3.334,26.666h4.904l-1.49,13.415  C15.938,84.036,21.274,90,28.608,90H71.39c7.334,0,12.673-5.964,11.862-13.252l-1.491-13.415h4.906L90,36.667z M60,80H40v-6.667h20  V80z M70,60c0,2.751-2.249,5-5,5H35c-2.75,0-5-2.249-5-5V48.333c0-2.75,2.25-5,5-5h30c2.751,0,5,2.25,5,5V60z" />
                                        <path
                                            d="M38.334,52.5c0-1.843,1.492-3.333,3.332-3.333c1.844,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.49,3.334-3.334,3.334  c-1.84,0-3.332-1.491-3.332-3.334V52.5z" />
                                        <path
                                            d="M55,52.5c0-1.843,1.491-3.333,3.333-3.333c1.843,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.491,3.334-3.334,3.334  c-1.842,0-3.333-1.491-3.333-3.334V52.5z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button id="btn-back" class="btn-secondary">BACK</button>
                    <button id="btn-start-game" class="btn-primary">START GAME</button>
                </div>
            </div>
        </div>

        <!-- In-Game UI Overlay -->
        <div id="game-ui-overlay" class="screen hidden no-bg">
            <!-- Top Bar -->
            <div class="game-header">
                <img src="/src/assets/logo.png" alt="Logo" class="mini-logo">
                <button id="btn-menu" class="icon-btn">☰</button>
            </div>

            <!-- Player Avatars (Absolute positioned via CSS to match corners/sides) -->
            <div id="avatar-container">
                <!-- Injected dynamically -->
            </div>

            <!-- Tap to Roll Button (for human players only) -->
            <button id="tap-to-roll" class="hidden">
                <svg viewBox="-5.0 -10.0 110.0 135.0" fill="currentColor">
                    <path
                        d="m31.531 63.914-8.7383-8.7383c-2.1328-2.1328-5.5352-2.5977-8.0039-0.87109-2.875 2.0117-3.4648 5.8867-1.5117 8.6289l15.609 21.93c6.0703 7.9648 15.512 12.637 25.527 12.637h6.6875c14.781 0 26.762-11.98 26.762-26.762v-48.168c0-2.957-2.3945-5.3516-5.3516-5.3516s-5.3516 2.3945-5.3516 5.3516v20.738c0 1.1094-0.89844 2.0078-2.0078 2.0078s-2.0078-0.89844-2.0078-2.0078v-30.105c0-2.957-2.3945-5.3516-5.3516-5.3516s-5.3516 2.3945-5.3516 5.3516v30.105c0 1.1094-0.89844 2.0078-2.0078 2.0078s-2.0078-0.89844-2.0078-2.0078v-35.227c0-2.7969-2.043-5.293-4.8281-5.5547-3.1914-0.30469-5.875 2.1992-5.875 5.3281v35.457c0 1.1094-0.89844 2.0078-2.0078 2.0078s-2.0078-0.89844-2.0078-2.0078l0.003907-28.77c0-2.957-2.3945-5.3516-5.3516-5.3516s-5.3516 2.3945-5.3516 5.3516v48.762c0 0.76562-0.93359 1.1523-1.4766 0.60937z" />
                </svg>

            </button>

        </div>
    </div>

    <div id="game-container">
        <canvas id="canvas-board"></canvas>
        <canvas id="canvas-tokens"></canvas>
        <canvas id="canvas-3d"></canvas>
        <canvas id="ui-canvas"></canvas>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container"></div>

    <!-- In-Game Menu Modal (Moved to Root) -->
    <div id="in-game-menu" class="hidden">
        <div class="menu-content">
            <h3>GAME MENU</h3>
            <div class="menu-options">
                <button id="btn-resume" class="btn-primary">RESUME</button>
                <button id="btn-restart" class="btn-secondary">RESTART MATCH</button>
                <button id="btn-quit" class="btn-danger">QUIT MATCH</button>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="game-over-modal" class="hidden">
        <div class="game-over-content">
            <div class="game-over-header">
                <img src="/src/assets/trophy.png" alt="Trophy" class="header-trophy left-trophy">
                <h2>GAME OVER</h2>
                <img src="/src/assets/trophy.png" alt="Trophy" class="header-trophy">
            </div>
            <div class="rankings">
                <div class="rank rank-1">
                    <div class="rank-badge-container">
                        <img id="rank-1-medal" src="/src/assets/1st-medal.png" alt="1st" class="rank-medal-img">
                        <span id="rank-1-number" class="rank-number-overlay" style="display: none;">1</span>
                    </div>
                    <span class="rank-label">1st</span>
                    <span class="rank-name" id="rank-1-name">-</span>
                </div>
                <div class="rank rank-2">
                    <div class="rank-badge-container">
                        <img id="rank-2-medal" src="/src/assets/2nd-medal.png" alt="2nd" class="rank-medal-img">
                        <span id="rank-2-number" class="rank-number-overlay" style="display: none;">2</span>
                    </div>
                    <span class="rank-label">2nd</span>
                    <span class="rank-name" id="rank-2-name">-</span>
                </div>
                <div class="rank rank-3">
                    <div class="rank-badge-container">
                        <img id="rank-3-medal" src="/src/assets/3rd-medal.png" alt="3rd" class="rank-medal-img">
                        <span id="rank-3-number" class="rank-number-overlay" style="display: none;">3</span>
                    </div>
                    <span class="rank-label">3rd</span>
                    <span class="rank-name" id="rank-3-name">-</span>
                </div>
                <div class="rank rank-4">
                    <div class="rank-badge-container">
                        <img id="rank-4-medal" src="/src/assets/looser-medal.png" alt="4th" class="rank-medal-img">
                        <span id="rank-4-number" class="rank-number-overlay">4</span>
                    </div>
                    <span class="rank-label">4th</span>
                    <span class="rank-name" id="rank-4-name">-</span>
                </div>
            </div>
            <div class="game-over-buttons">
                <button id="btn-game-over-restart" class="btn-primary">PLAY AGAIN</button>
                <button id="btn-game-over-quit" class="btn-secondary">QUIT</button>
            </div>
        </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
</body>

</html>