<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="theme-color" content="#1A1A2E" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
    <title>Premium Ludo</title>
    <link rel="stylesheet" href="/src/styles/ui.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #010325;
            font-family: 'Outfit', 'Segoe UI', system-ui, -apple-system, sans-serif;
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        /* Background image layer with opacity */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('/game-bg.jpg') center center / cover no-repeat;
            opacity: 0.5;
            z-index: 0;
            mix-blend-mode: overlay;
            pointer-events: none;
        }

        /* Mobile portrait: rotate background 90deg */
        @media (orientation: portrait) {
            body::before {
                width: 100vh;
                height: 100vw;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(90deg);
            }
        }

        #game-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        #canvas-board {
            position: absolute;
            z-index: 1;
        }

        #canvas-tokens {
            position: absolute;
            z-index: 2;
        }

        #canvas-3d {
            position: absolute;
            z-index: 3;
            pointer-events: none;
        }

        #ui-canvas {
            position: absolute;
            z-index: 4;
            pointer-events: none;
        }

        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1A1A2E 0%, #0F0F1A 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            transition: opacity 0.5s ease;
        }

        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #2A2A4A;
            border-top-color: #E53935;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
    </div>
    <div id="ui-layer">
        <!-- Start Screen -->
        <div id="start-screen" class="screen active">
            <div class="logo-container">
                <img src="/src/assets/logo.png" alt="Ludo" class="game-logo">
            </div>
            <button id="btn-play-initial" class="btn-primary">PLAY LUDO</button>
        </div>

        <!-- Setup Screen -->
        <div id="setup-screen" class="screen hidden">
            <div class="modal-content">
                <h2>GAME SETUP</h2>

                <div class="form-group">
                    <label>Select Players</label>
                    <div class="player-grid">
                        <!-- Red - Top Left -->
                        <div class="player-cell selected" data-player="0" data-color="red">
                            <div class="cell-bg-letter">R</div>
                            <div class="player-tag">
                                <span class="color-dot red"></span>
                                <input type="text" id="p0-name" value="Player 1" placeholder="Name">
                                <span class="edit-icon">✎</span>
                            </div>
                            <div class="player-type-toggle">
                                <button class="type-btn human active" data-type="human">
                                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                        <path
                                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                    </svg>
                                </button>
                                <button class="type-btn bot" data-type="bot">
                                    <svg viewBox="0 0 100 125" width="16" height="16" fill="currentColor"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M90,36.667h-4.167L79.98,47.312l-0.82-7.373C78.555,34.473,73.558,30,68.057,30H53.333v-7.591  c1.986-1.156,3.334-3.281,3.334-5.743C56.667,12.985,53.682,10,50,10s-6.666,2.985-6.666,6.667c0,2.461,1.349,4.586,3.332,5.743V30  H31.941c-5.5,0-10.496,4.473-11.104,9.938l-0.818,7.369l-5.854-10.641H10l3.334,26.666h4.904l-1.49,13.415  C15.938,84.036,21.274,90,28.608,90H71.39c7.334,0,12.673-5.964,11.862-13.252l-1.491-13.415h4.906L90,36.667z M60,80H40v-6.667h20  V80z M70,60c0,2.751-2.249,5-5,5H35c-2.75,0-5-2.249-5-5V48.333c0-2.75,2.25-5,5-5h30c2.751,0,5,2.25,5,5V60z" />
                                        <path
                                            d="M38.334,52.5c0-1.843,1.492-3.333,3.332-3.333c1.844,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.49,3.334-3.334,3.334  c-1.84,0-3.332-1.491-3.332-3.334V52.5z" />
                                        <path
                                            d="M55,52.5c0-1.843,1.491-3.333,3.333-3.333c1.843,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.491,3.334-3.334,3.334  c-1.842,0-3.333-1.491-3.333-3.334V52.5z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <!-- Green - Top Right -->
                        <div class="player-cell" data-player="1" data-color="green">
                            <div class="cell-bg-letter">G</div>
                            <div class="player-tag">
                                <span class="color-dot green"></span>
                                <input type="text" id="p1-name" value="Player 2" placeholder="Name">
                                <span class="edit-icon">✎</span>
                            </div>
                            <div class="player-type-toggle">
                                <button class="type-btn human active" data-type="human">
                                    <svg viewBox="0 0 24 25" width="18" height="18" fill="currentColor">
                                        <path
                                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                    </svg>
                                </button>
                                <button class="type-btn bot" data-type="bot">
                                    <svg viewBox="0 0 100 125" width="16" height="16" fill="currentColor"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M90,36.667h-4.167L79.98,47.312l-0.82-7.373C78.555,34.473,73.558,30,68.057,30H53.333v-7.591  c1.986-1.156,3.334-3.281,3.334-5.743C56.667,12.985,53.682,10,50,10s-6.666,2.985-6.666,6.667c0,2.461,1.349,4.586,3.332,5.743V30  H31.941c-5.5,0-10.496,4.473-11.104,9.938l-0.818,7.369l-5.854-10.641H10l3.334,26.666h4.904l-1.49,13.415  C15.938,84.036,21.274,90,28.608,90H71.39c7.334,0,12.673-5.964,11.862-13.252l-1.491-13.415h4.906L90,36.667z M60,80H40v-6.667h20  V80z M70,60c0,2.751-2.249,5-5,5H35c-2.75,0-5-2.249-5-5V48.333c0-2.75,2.25-5,5-5h30c2.751,0,5,2.25,5,5V60z" />
                                        <path
                                            d="M38.334,52.5c0-1.843,1.492-3.333,3.332-3.333c1.844,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.49,3.334-3.334,3.334  c-1.84,0-3.332-1.491-3.332-3.334V52.5z" />
                                        <path
                                            d="M55,52.5c0-1.843,1.491-3.333,3.333-3.333c1.843,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.491,3.334-3.334,3.334  c-1.842,0-3.333-1.491-3.333-3.334V52.5z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <!-- Blue - Bottom Left -->
                        <div class="player-cell" data-player="3" data-color="blue">
                            <div class="cell-bg-letter">B</div>
                            <div class="player-tag">
                                <span class="color-dot blue"></span>
                                <input type="text" id="p3-name" value="Player 4" placeholder="Name">
                                <span class="edit-icon">✎</span>
                            </div>
                            <div class="player-type-toggle">
                                <button class="type-btn human active" data-type="human">
                                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                        <path
                                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                    </svg>
                                </button>
                                <button class="type-btn bot" data-type="bot">
                                    <svg viewBox="0 0 100 125" width="16" height="16" fill="currentColor"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M90,36.667h-4.167L79.98,47.312l-0.82-7.373C78.555,34.473,73.558,30,68.057,30H53.333v-7.591  c1.986-1.156,3.334-3.281,3.334-5.743C56.667,12.985,53.682,10,50,10s-6.666,2.985-6.666,6.667c0,2.461,1.349,4.586,3.332,5.743V30  H31.941c-5.5,0-10.496,4.473-11.104,9.938l-0.818,7.369l-5.854-10.641H10l3.334,26.666h4.904l-1.49,13.415  C15.938,84.036,21.274,90,28.608,90H71.39c7.334,0,12.673-5.964,11.862-13.252l-1.491-13.415h4.906L90,36.667z M60,80H40v-6.667h20  V80z M70,60c0,2.751-2.249,5-5,5H35c-2.75,0-5-2.249-5-5V48.333c0-2.75,2.25-5,5-5h30c2.751,0,5,2.25,5,5V60z" />
                                        <path
                                            d="M38.334,52.5c0-1.843,1.492-3.333,3.332-3.333c1.844,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.49,3.334-3.334,3.334  c-1.84,0-3.332-1.491-3.332-3.334V52.5z" />
                                        <path
                                            d="M55,52.5c0-1.843,1.491-3.333,3.333-3.333c1.843,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.491,3.334-3.334,3.334  c-1.842,0-3.333-1.491-3.333-3.334V52.5z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <!-- Yellow - Bottom Right -->
                        <div class="player-cell selected" data-player="2" data-color="yellow">
                            <div class="cell-bg-letter">Y</div>
                            <div class="player-tag">
                                <span class="color-dot yellow"></span>
                                <input type="text" id="p2-name" value="Player 3" placeholder="Name">
                                <span class="edit-icon">✎</span>
                            </div>
                            <div class="player-type-toggle">
                                <button class="type-btn human active" data-type="human">
                                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                        <path
                                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                    </svg>
                                </button>
                                <button class="type-btn bot" data-type="bot">
                                    <svg viewBox="0 0 100 125" width="16" height="16" fill="currentColor"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M90,36.667h-4.167L79.98,47.312l-0.82-7.373C78.555,34.473,73.558,30,68.057,30H53.333v-7.591  c1.986-1.156,3.334-3.281,3.334-5.743C56.667,12.985,53.682,10,50,10s-6.666,2.985-6.666,6.667c0,2.461,1.349,4.586,3.332,5.743V30  H31.941c-5.5,0-10.496,4.473-11.104,9.938l-0.818,7.369l-5.854-10.641H10l3.334,26.666h4.904l-1.49,13.415  C15.938,84.036,21.274,90,28.608,90H71.39c7.334,0,12.673-5.964,11.862-13.252l-1.491-13.415h4.906L90,36.667z M60,80H40v-6.667h20  V80z M70,60c0,2.751-2.249,5-5,5H35c-2.75,0-5-2.249-5-5V48.333c0-2.75,2.25-5,5-5h30c2.751,0,5,2.25,5,5V60z" />
                                        <path
                                            d="M38.334,52.5c0-1.843,1.492-3.333,3.332-3.333c1.844,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.49,3.334-3.334,3.334  c-1.84,0-3.332-1.491-3.332-3.334V52.5z" />
                                        <path
                                            d="M55,52.5c0-1.843,1.491-3.333,3.333-3.333c1.843,0,3.334,1.49,3.334,3.333v3.333c0,1.843-1.491,3.334-3.334,3.334  c-1.842,0-3.333-1.491-3.333-3.334V52.5z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button id="btn-back" class="btn-secondary">BACK</button>
                    <button id="btn-start-game" class="btn-primary">START GAME</button>
                </div>
            </div>
        </div>

        <!-- In-Game UI Overlay -->
        <div id="game-ui-overlay" class="screen hidden no-bg">
            <!-- Top Bar -->
            <div class="game-header">
                <img src="/src/assets/logo.png" alt="Logo" class="mini-logo">
                <button id="btn-menu" class="icon-btn">☰</button>
            </div>

            <!-- Player Avatars (Absolute positioned via CSS to match corners/sides) -->
            <div id="avatar-container">
                <!-- Injected dynamically -->
            </div>
        </div>
    </div>

    <div id="game-container">
        <canvas id="canvas-board"></canvas>
        <canvas id="canvas-tokens"></canvas>
        <canvas id="canvas-3d"></canvas>
        <canvas id="ui-canvas"></canvas>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container"></div>

    <script type="module" src="/src/main.ts"></script>
</body>

</html>